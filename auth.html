<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kazi Mashinani - Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* CSS styles would go here - shortened for brevity */
        :root {
            --employee-primary: #10b981;
            --employee-secondary: #059669;
            --employee-accent: #34d399;
            --employee-light: #d1fae5;
            
            --employer-primary: #3b82f6;
            --employer-secondary: #1d4ed8;
            --employer-accent: #60a5fa;
            --employer-light: #dbeafe;
            
            --text-color: #1f2937;
            --light-bg: #f8fafc;
            --white: #ffffff;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.07);
            --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
            --shadow-xl: 0 20px 25px rgba(0,0,0,0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8fafc;
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Add all the other CSS styles from the previous version */
        /* ... */

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo">
                <i class="fas fa-hands-helping"></i>
                <h1 data-en="Kazi Mashinani" data-sw="Kazi Mashinani">Kazi Mashinani</h1>
            </div>
            <div style="display: flex; align-items: center;">
                <div class="language-switcher" onclick="toggleLanguage()">
                    <div class="language-flag">
                        <span id="currentFlag">ðŸ‡°ðŸ‡ª</span>
                    </div>
                    <div class="language-name" id="currentLanguage">Kiswahili</div>
                </div>
                <div class="user-info">
                    <div class="user-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div>
                        <div id="userName">Loading...</div>
                        <div class="user-role-badge" id="userRoleBadge">Loading...</div>
                        <button class="btn-logout" onclick="logout()">
                            <i class="fas fa-sign-out-alt"></i> <span data-en="Logout" data-sw="Toka">Toka</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Employee Navigation -->
    <div id="employeeNav" class="nav-container hidden">
        <div class="nav-item active" onclick="showSection('home')">
            <i class="fas fa-home"></i> <span data-en="Home" data-sw="Nyumbani">Nyumbani</span>
        </div>
        <div class="nav-item" onclick="showSection('jobs')">
            <i class="fas fa-briefcase"></i> <span data-en="Available Jobs" data-sw="Kazi Zilizopo">Kazi Zilizopo</span>
        </div>
        <div class="nav-item" onclick="showSection('applications')">
            <i class="fas fa-file-alt"></i> <span data-en="My Applications" data-sw="Maombi Yangu">Maombi Yangu</span>
        </div>
        <div class="nav-item" onclick="showSection('profile')">
            <i class="fas fa-user"></i> <span data-en="My Profile" data-sw="Wasifu Wangu">Wasifu Wangu</span>
        </div>
    </div>

    <!-- Employer Navigation -->
    <div id="employerNav" class="nav-container hidden">
        <div class="nav-item active" onclick="showSection('home')">
            <i class="fas fa-home"></i> <span data-en="Home" data-sw="Nyumbani">Nyumbani</span>
        </div>
        <div class="nav-item" onclick="showSection('post')">
            <i class="fas fa-plus-circle"></i> <span data-en="Post Job" data-sw="Tanga Kazi">Tanga Kazi</span>
        </div>
        <div class="nav-item" onclick="showSection('myJobs')">
            <i class="fas fa-list"></i> <span data-en="My Jobs" data-sw="Kazi Zangu">Kazi Zangu</span>
        </div>
        <div class="nav-item" onclick="showSection('employees')">
            <i class="fas fa-users"></i> <span data-en="Find Workers" data-sw="Tafuta Wafanyikazi">Tafuta Wafanyikazi</span>
        </div>
        <div class="nav-item" onclick="showSection('profile')">
            <i class="fas fa-user"></i> <span data-en="My Profile" data-sw="Wasifu Wangu">Wasifu Wangu</span>
        </div>
    </div>

    <div class="main-container">
        <!-- Home Section -->
        <section id="homeSection">
            <div class="welcome-section">
                <h1 id="welcomeMessage" data-en="Welcome to Kazi Mashinani!" data-sw="Karibu Kazi Mashinani!">Karibu Kazi Mashinani!</h1>
                <p id="welcomeSubtitle" data-en="Find your perfect job opportunity in rural areas" data-sw="Tafuta fursa bora za kazi katika maeneo ya vijijini">Tafuta fursa bora za kazi katika maeneo ya vijijini</p>
            </div>

            <!-- Stats Section -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-briefcase"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalJobs">0</h3>
                        <p id="jobsLabel" data-en="Available Jobs" data-sw="Kazi Zilizopo">Kazi Zilizopo</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-paper-plane"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="totalApplications">0</h3>
                        <p id="applicationsLabel" data-en="Applications Sent" data-sw="Maombi Yaliyotumwa">Maombi Yaliyotumwa</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="acceptedApplications">0</h3>
                        <p id="acceptedLabel" data-en="Accepted Applications" data-sw="Maombi Yaliyokubaliwa">Maombi Yaliyokubaliwa</p>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="container">
                <div class="section-header">
                    <i class="fas fa-bolt"></i>
                    <h2 data-en="Quick Actions" data-sw="Vitendo Vya Haraka">Vitendo Vya Haraka</h2>
                </div>
                <div id="quickActions" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                    <!-- Quick actions will be populated based on user role -->
                </div>
            </div>

            <!-- Professional Blog Section -->
            <div class="container">
                <div class="section-header">
                    <i class="fas fa-newspaper"></i>
                    <h2 id="blogTitle" data-en="Career Tips & Updates" data-sw="Vidokezo Vya Kazi na Taarifa">Vidokezo Vya Kazi na Taarifa</h2>
                </div>
                
                <div class="blog-grid" id="blogContent">
                    <!-- Blog content will be loaded here -->
                </div>
            </div>
        </section>

        <!-- Other sections would follow the same pattern -->
        <!-- ... -->

    </div>

    <footer>
        <div class="footer-content">
            <div>
                <h3 id="footerText" data-en="Kazi Mashinani - Empowering Rural Job Seekers" data-sw="Kazi Mashinani - Kuwawezesha Watafuta Kazi Vijijini">Kazi Mashinani - Kuwawezesha Watafuta Kazi Vijijini</h3>
            </div>
            <div class="footer-contact">
                <div class="contact-icon" onclick="contactPhone()">
                    <i class="fas fa-phone"></i>
                </div>
                <div class="contact-icon" onclick="contactEmail()">
                    <i class="fas fa-envelope"></i>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Configuration
        const API_BASE_URL = 'https://backita.onrender.com';
        let currentUser = null;
        let currentLanguage = 'en';
        let currentJobs = [];
        let currentApplications = [];
        let myJobs = [];
        let currentEmployees = [];

        // Check authentication on page load
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthentication();
        });

        async function checkAuthentication() {
            try {
                const token = localStorage.getItem('token');
                const storedUser = localStorage.getItem('user');
                const storedRole = localStorage.getItem('userRole');
                
                if (token && storedUser && storedRole) {
                    try {
                        currentUser = JSON.parse(storedUser);
                        currentUser.role = storedRole;
                        
                        initializeApp();
                        return;
                    } catch (error) {
                        console.error('Error parsing stored user data:', error);
                        localStorage.removeItem('token');
                        localStorage.removeItem('user');
                        localStorage.removeItem('userRole');
                        redirectToAuth();
                    }
                } else {
                    redirectToAuth();
                }
            } catch (error) {
                console.error('Authentication check failed:', error);
                redirectToAuth();
            }
        }

        function redirectToAuth() {
            window.location.href = 'auth.html';
        }

        function initializeApp() {
            // Update UI with user info
            document.getElementById('userName').textContent = currentUser.name;
            
            // Set language
            const savedLanguage = localStorage.getItem('preferredLanguage');
            if (savedLanguage) {
                currentLanguage = savedLanguage;
            }
            updateLanguageDisplay();
            translatePage();
            
            // Setup role-specific UI
            setupRoleUI();
            
            // Load initial data
            loadInitialData();
            
            // Setup event listeners
            setupEventListeners();
        }

        function setupRoleUI() {
            const isEmployee = currentUser.role === 'employee';
            
            // Update CSS variables based on role
            if (isEmployee) {
                document.documentElement.style.setProperty('--primary-color', 'var(--employee-primary)');
                document.documentElement.style.setProperty('--secondary-color', 'var(--employee-secondary)');
                document.documentElement.style.setProperty('--accent-color', 'var(--employee-accent)');
                document.documentElement.style.setProperty('--light-color', 'var(--employee-light)');
                document.documentElement.style.setProperty('--gradient-1', 'linear-gradient(135deg, var(--employee-primary) 0%, var(--employee-secondary) 100%)');
                document.documentElement.style.setProperty('--gradient-2', 'linear-gradient(135deg, var(--employee-accent) 0%, var(--employee-primary) 100%)');
                
                // Show employee navigation
                document.getElementById('employeeNav').classList.remove('hidden');
                document.getElementById('employerNav').classList.add('hidden');
                
                // Update role badge
                document.getElementById('userRoleBadge').textContent = currentLanguage === 'en' ? 'Job Seeker' : 'Mtafuta Kazi';
                
                // Update welcome subtitle
                document.getElementById('welcomeSubtitle').textContent = currentLanguage === 'en' 
                    ? 'Find your perfect job opportunity in rural areas' 
                    : 'Tafuta fursa bora za kazi katika maeneo ya vijijini';
                
                // Update blog title
                document.getElementById('blogTitle').textContent = currentLanguage === 'en' 
                    ? 'Career Tips & Updates' 
                    : 'Vidokezo Vya Kazi na Taarifa';
                
                // Update footer text
                document.getElementById('footerText').textContent = currentLanguage === 'en' 
                    ? 'Kazi Mashinani - Empowering Rural Job Seekers' 
                    : 'Kazi Mashinani - Kuwawezesha Watafuta Kazi Vijijini';
                
                // Setup quick actions for employee
                document.getElementById('quickActions').innerHTML = '<button class="btn-primary" onclick="showSection(\'jobs\')"><i class="fas fa-search"></i> <span data-en="Browse Jobs" data-sw="Tafuta Kazi">Tafuta Kazi</span></button><button class="btn-primary" onclick="showSection(\'profile\')"><i class="fas fa-user-edit"></i> <span data-en="Update Profile" data-sw="Sasisha Wasifu">Sasisha Wasifu</span></button>';
                
                // Setup profile content for employee
                document.getElementById('profileContent').innerHTML = '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;"><div class="form-group"><label data-en="Full Name" data-sw="Jina Kamili">Jina Kamili</label><input type="text" id="profileName" value="' + currentUser.name + '" readonly></div><div class="form-group"><label data-en="Phone Number" data-sw="Nambari ya Simu">Nambari ya Simu</label><input type="text" id="profilePhone" value="' + currentUser.phone + '" readonly></div><div class="form-group"><label data-en="Location" data-sw="Eneo">Eneo</label><input type="text" id="profileLocation" value="' + currentUser.location + '" readonly></div><div class="form-group"><label data-en="Specialization" data-sw="Utaalamu">Utaalamu</label><input type="text" id="profileSpecialization" value="' + (currentUser.specialization || '') + '" readonly></div></div>';
            } else {
                document.documentElement.style.setProperty('--primary-color', 'var(--employer-primary)');
                document.documentElement.style.setProperty('--secondary-color', 'var(--employer-secondary)');
                document.documentElement.style.setProperty('--accent-color', 'var(--employer-accent)');
                document.documentElement.style.setProperty('--light-color', 'var(--employer-light)');
                document.documentElement.style.setProperty('--gradient-1', 'linear-gradient(135deg, var(--employer-primary) 0%, var(--employer-secondary) 100%)');
                document.documentElement.style.setProperty('--gradient-2', 'linear-gradient(135deg, var(--employer-accent) 0%, var(--employer-primary) 100%)');
                
                // Show employer navigation
                document.getElementById('employerNav').classList.remove('hidden');
                document.getElementById('employeeNav').classList.add('hidden');
                
                // Update role badge
                document.getElementById('userRoleBadge').textContent = currentLanguage === 'en' ? 'Employer' : 'Mwajiri';
                
                // Update welcome subtitle
                document.getElementById('welcomeSubtitle').textContent = currentLanguage === 'en' 
                    ? 'Find qualified workers for your business needs' 
                    : 'Tafuta wafanyikazi waliohitimu kwa mahitaji ya biashara yako';
                
                // Update blog title
                document.getElementById('blogTitle').textContent = currentLanguage === 'en' 
                    ? 'Business Tips & Updates' 
                    : 'Vidokezo Vya Biashara na Taarifa';
                
                // Update footer text
                document.getElementById('footerText').textContent = currentLanguage === 'en' 
                    ? 'Kazi Mashinani - Connecting Employers with Rural Talent' 
                    : 'Kazi Mashinani - Kuunganisha Waajiri na Watalanta Vijijini';
                
                // Setup quick actions for employer
                document.getElementById('quickActions').innerHTML = '<button class="btn-primary" onclick="showSection(\'post\')"><i class="fas fa-plus"></i> <span data-en="Post New Job" data-sw="Tanga Kazi Mpya">Tanga Kazi Mpya</span></button><button class="btn-primary" onclick="showSection(\'employees\')"><i class="fas fa-search"></i> <span data-en="Find Workers" data-sw="Tafuta Wafanyikazi">Tafuta Wafanyikazi</span></button>';
                
                // Setup profile content for employer
                document.getElementById('profileContent').innerHTML = '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;"><div class="form-group"><label data-en="Business Name" data-sw="Jina la Biashara">Jina la Biashara</label><input type="text" id="profileName" value="' + currentUser.name + '" readonly></div><div class="form-group"><label data-en="Phone Number" data-sw="Nambari ya Simu">Nambari ya Simu</label><input type="text" id="profilePhone" value="' + currentUser.phone + '" readonly></div><div class="form-group"><label data-en="Location" data-sw="Eneo">Eneo</label><input type="text" id="profileLocation" value="' + currentUser.location + '" readonly></div><div class="form-group"><label data-en="Business Type" data-sw="Aina ya Biashara">Aina ya Biashara</label><input type="text" id="profileBusinessType" value="' + (currentUser.jobType || '') + '" readonly></div></div>';
            }
            
            // Update welcome message
            document.getElementById('welcomeMessage').textContent = currentLanguage === 'en' 
                ? 'Welcome ' + currentUser.name + '!' 
                : 'Karibu ' + currentUser.name + '!';
        }

        // Add the rest of the JavaScript functions here
        // ...

        function logout() {
            // Clear all stored data
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            localStorage.removeItem('userRole');
            
            // Redirect to auth page
            window.location.href = 'auth.html';
        }

        // Global functions
        window.showSection = showSection;
        window.toggleLanguage = toggleLanguage;
        window.logout = logout;
    </script>
</body>
</html>
